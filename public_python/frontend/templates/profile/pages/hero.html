<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Hero Section</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<style>
    .nav-tabs .nav-link.active {
        background-color: #007bff;
        color: white;
    }
    .tab-content {
        border: 1px solid #dee2e6;
        border-top: 0;
        padding: 20px;
    }
    .remove-btn {
        background-color: #dc3545;
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
    }
    .remove-btn:hover {
        background-color: #c82333;
    }
</style>
</head>
<body>
    {% include 'profile/navbar.html' %}

    <div class="container mt-5">
        <h1>Panel Administracyjny</h1>
        <form action="{{ url_for('user.update_hero') }}" method="POST" enctype="multipart/form-data">
            <!-- Zakładki (Tabs) -->
            <ul class="nav nav-tabs" id="adminTabs" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="carousel-tab" data-bs-toggle="tab" href="#carousel" role="tab" aria-controls="carousel" aria-selected="true">Carousel</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="main-section-tab" data-bs-toggle="tab" href="#main-section" role="tab" aria-controls="main-section" aria-selected="false">Main Section</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="team-tab" data-bs-toggle="tab" href="#team" role="tab" aria-controls="team" aria-selected="false">Team</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="jumbotron-tab" data-bs-toggle="tab" href="#jumbotron" role="tab" aria-controls="jumbotron" aria-selected="false">Jumbotron</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="articles-tab" data-bs-toggle="tab" href="#articles" role="tab" aria-controls="articles" aria-selected="false">Articles</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="adventure-tab" data-bs-toggle="tab" href="#adventure" role="tab" aria-controls="adventure" aria-selected="false">Adventure</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="partners-tab" data-bs-toggle="tab" href="#partners" role="tab" aria-controls="partners" aria-selected="false">Partners</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="video-tab" data-bs-toggle="tab" href="#video" role="tab" aria-controls="video" aria-selected="false">Video</a>
                </li>
            </ul>

            <div class="tab-content" id="adminTabContent">
                <!-- Carousel Section -->
                <div class="tab-pane fade show active" id="carousel" role="tabpanel" aria-labelledby="carousel-tab">
                    <div class="container">
                        <div class="row" id="carouselItemsContainer">
                            {% for item in json_data.carouselItems %}
                            <div class="col-md-4 mb-3" data-index="{{ loop.index }}">
                                <div class="card">
                                    <div class="card-header">
                                        Slide {{ loop.index }}
                                        <button type="button" class="btn btn-warning btn-sm float-end ms-2 edit-btn">Edit</button>
                                        <button type="button" class="btn btn-danger btn-sm float-end remove-btn">Remove</button>
                                    </div>
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label for="videoSrc_{{ loop.index }}" class="form-label">Video Source:</label>
                                            <input type="text" class="form-control" id="videoSrc_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][videoSrc]" value="{{ item.videoSrc }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="videoMobileSrc_{{ loop.index }}" class="form-label">Video Mobile Source:</label>
                                            <input type="text" class="form-control" id="videoMobileSrc_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][videoMobileSrc]" value="{{ item.videoMobileSrc }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="maskColor_{{ loop.index }}" class="form-label">Mask Color:</label>
                                            <input type="text" class="form-control" id="maskColor_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][maskColor]" value="{{ item.maskColor }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="heading_{{ loop.index }}" class="form-label">Heading:</label>
                                            <input type="text" class="form-control" id="heading_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][heading]" value="{{ item.heading }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="subheading_{{ loop.index }}" class="form-label">Subheading:</label>
                                            <input type="text" class="form-control" id="subheading_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][subheading]" value="{{ item.subheading }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="buttonText_{{ loop.index }}" class="form-label">Button Text:</label>
                                            <input type="text" class="form-control" id="buttonText_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][buttons][0][text]" value="{{ item.buttons[0].text }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="buttonUrl_{{ loop.index }}" class="form-label">Button URL:</label>
                                            <input type="text" class="form-control" id="buttonUrl_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][buttons][0][url]" value="{{ item.buttons[0].url }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="buttonClass_{{ loop.index }}" class="form-label">Button Class:</label>
                                            <input type="text" class="form-control" id="buttonClass_{{ loop.index }}" name="carouselItems[{{ loop.index0 }}][buttons][0][class]" value="{{ item.buttons[0].class }}" readonly>
                                        </div>
                                        <div class="mb-3">
                                            <label for="videoPreview_{{ loop.index }}" class="form-label">Video Preview:</label>
                                            <video id="videoPreview_{{ loop.index }}" class="w-100" controls>
                                                <source src="{{ url_for('static', filename=item.videoSrc.lstrip('/')) }}" type="video/mp4">
                                                Your browser does not support the video tag.
                                            </video>                        
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>

                        <!-- Button to add a new item -->
                        <div class="d-flex justify-content-center mt-3">
                            <button type="button" class="btn btn-primary" id="addNewItemBtn">Add New Item</button>
                        </div>
                    </div>
                </div>
                <!-- Main Section -->
                <div class="tab-pane fade" id="main-section" role="tabpanel" aria-labelledby="main-section-tab">
                    <h2>Main Section</h2>
                    <div class="mb-3">
                        <!-- Obrazek z dynamicznym źródłem i responsywnymi stylami -->
                        <img id="imagePreview" 
                             src="{{ url_for('static', filename=json_data.mainSection.backgroundURL) }}" 
                             alt="Image preview" 
                             style="max-width: 100%; height: auto;">
                    
                        <!-- Etykieta i pole tekstowe do wprowadzenia URL obrazu -->
                        <label for="mainBackgroundURL" class="form-label">Background Image URL</label>
                        <input type="text" 
                               class="form-control" 
                               id="mainBackgroundURL" 
                               name="mainSection[backgroundURL]" 
                               value="{{ json_data.mainSection.backgroundURL }}">
                    </div>                    
                    <div class="mb-3">
                        <label for="mainTitle1" class="form-label">Title 1</label>
                        <input type="text" class="form-control" id="mainTitle1" name="mainSection[title1]" value="{{ json_data.mainSection.title1 }}">
                    </div>
                    <div class="mb-3">
                        <label for="mainTitle2" class="form-label">Title 2</label>
                        <input type="text" class="form-control" id="mainTitle2" name="mainSection[title2]" value="{{ json_data.mainSection.title2 }}">
                    </div>
                    <div class="mb-3">
                        <label for="mainButton1Text" class="form-label">Button 1 Text</label>
                        <input type="text" class="form-control" id="mainButton1Text" name="mainSection[button1Text]" value="{{ json_data.mainSection.button1Text }}">
                    </div>
                    <div class="mb-3">
                        <label for="mainButton2Text" class="form-label">Button 2 Text</label>
                        <input type="text" class="form-control" id="mainButton2Text" name="mainSection[button2Text]" value="{{ json_data.mainSection.button2Text }}">
                    </div>
                    <div class="mb-3">
                        <label for="mainPhoneNumber" class="form-label">Phone Number</label>
                        <input type="text" class="form-control" id="mainPhoneNumber" name="mainSection[phoneNumber]" value="{{ json_data.mainSection.phoneNumber }}">
                    </div>
                    <div class="mb-3">
                        <label for="mainEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="mainEmail" name="mainSection[email]" value="{{ json_data.mainSection.email }}">
                    </div>
                </div>

                <!-- Team Section -->
                <div class="tab-pane fade" id="team" role="tabpanel" aria-labelledby="team-tab">
                    <h2 class="text-center mb-4">Team Members</h2>

                    <!-- Team Title and Subtitle -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="teamTitle" class="form-label">Team Title</label>
                                <input type="text" class="form-control" id="teamTitle" name="membersTeamSection[teamTitle]" value="{{ json_data.membersTeamSection.teamTitle }}">
                            </div>
                            <div class="mb-3">
                                <label for="teamSubtitle" class="form-label">Team Subtitle</label>
                                <input type="text" class="form-control" id="teamSubtitle" name="membersTeamSection[teamSubtitle]" value="{{ json_data.membersTeamSection.teamSubtitle }}">
                            </div>
                        </div>
                    </div>

                    <!-- Team Members List -->
                    <div id="team-list">
                        {% for member in json_data.membersTeamSection.members %}
                        <div class="card shadow-sm mb-4 team-member">
                            <div class="card-body">
                                <h4 class="card-title">Member {{ loop.index }}</h4>
                                
                                <!-- Name and Role -->
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="teamName{{ loop.index }}" class="form-label">Name</label>
                                        <input type="text" class="form-control" id="teamName{{ loop.index }}" name="membersTeamSection[members][{{ loop.index0 }}][name]" value="{{ member.name }}">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="teamRole{{ loop.index }}" class="form-label">Role</label>
                                        <input type="text" class="form-control" id="teamRole{{ loop.index }}" name="membersTeamSection[members][{{ loop.index0 }}][role]" value="{{ member.role }}">
                                    </div>
                                </div>

                                <!-- Image and Biography -->
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label for="teamImage{{ loop.index }}" class="form-label">Image URL</label>
                                        <!-- Pole tekstowe do wprowadzenia URL obrazu -->
                                        <div class="input-group">
                                            <input type="text" 
                                                   id="teamImage{{ loop.index }}" 
                                                   name="membersTeamSection[members][{{ loop.index0 }}][imageURL]" 
                                                   value="{{ member.imageURL }}" 
                                                   class="form-control" 
                                                   name="carouselItems[${newIndex - 1}][videoSrc]"
                                                   onchange="updateImagePreview('{{ loop.index }}')">
                                            <button type="button" 
                                                    class="btn btn-secondary browse-btn"
                                                    data-index="{{ loop.index }}"  
                                                    data-type="member_image"  
                                                    onclick="browseFiles(event)">
                                                <i class="bi bi-folder-symlink"></i> Browse Server Files
                                            </button>  <!-- Dodaj funkcje obsługującą ten button w javascript, powinna ona otwierać modala, a typ pliku member_image dodaj do python, na jego podstawie dostaniesz ścieżkę do właściwego katalogu  -->
                                        </div>
                                        <input type="file" class="form-control mt-2"data-type="member_image" accept="jpg">
                                        <!-- Miniaturka obrazu -->
                                        <div class="mt-2">
                                            <img id="imagePreview{{ loop.index }}" 
                                                src="{{ url_for('static', filename=member.imageURL) }}" 
                                                alt="Image preview" 
                                                style="max-width: 100%; height: auto; display: block; margin-top: 10px;">
                                        </div>
                                    </div>
                                    <div class="col-md-8 mb-3">
                                        <label for="teamBiography{{ loop.index }}" class="form-label">Biography</label>
                                        <textarea class="form-control" 
                                                id="teamBiography{{ loop.index }}" 
                                                name="membersTeamSection[members][{{ loop.index0 }}][details][biography]" 
                                                rows="3">{{ member.details.biography }}</textarea>
                                    </div>
                                </div>

                                <script>
                                    function updateImagePreview(index) {
                                        // Pobieranie URL obrazu z pola tekstowego
                                        const imageUrl = document.getElementById(`teamImage${index}`).value;
                                        // Ustawianie nowego URL w miniaturce obrazu
                                        document.getElementById(`imagePreview${index}`).src = imageUrl;
                                    }
                                </script>

                                <!-- Experience, Projects, Techniques -->
                                <div class="mb-3">
                                    <label for="teamExperience{{ loop.index }}" class="form-label">Experience</label>
                                    <textarea class="form-control" id="teamExperience{{ loop.index }}" name="membersTeamSection[members][{{ loop.index0 }}][details][expirience]" rows="2">{{ member.details.expirience }}</textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="teamProjects{{ loop.index }}" class="form-label">Projects</label>
                                    <textarea class="form-control" id="teamProjects{{ loop.index }}" name="membersTeamSection[members][{{ loop.index0 }}][details][projects]" rows="2">{{ member.details.projects }}</textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="teamTechniques{{ loop.index }}" class="form-label">Techniques</label>
                                    <textarea class="form-control" id="teamTechniques{{ loop.index }}" name="membersTeamSection[members][{{ loop.index0 }}][details][techniques]" rows="2">{{ member.details.techniques }}</textarea>
                                </div>

                                <!-- Social Icons and Links -->
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="teamSocialIcons{{ loop.index }}" class="form-label">Social Icons</label>
                                        {% for icon in member.socialIcons %}
                                        <input type="text" class="form-control mb-1" id="teamSocialIcons{{ loop.index }}_{{ loop.index0 }}" name="membersTeamSection[members][{{ loop.index0 }}][socialIcons][]" value="{{ icon }}">
                                        {% endfor %}
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="teamSocialLinks{{ loop.index }}" class="form-label">Social Links</label>
                                        {% for link in member.socialLinks %}
                                        <input type="text" class="form-control mb-1" id="teamSocialLinks{{ loop.index }}_{{ loop.index0 }}" name="membersTeamSection[members][{{ loop.index0 }}][socialLinks][]" value="{{ link }}">
                                        {% endfor %}
                                    </div>
                                </div>

                                <!-- Remove Button -->
                                <button type="button" class="btn btn-danger btn-sm mt-3" onclick="removeTeamMember(this)">Usuń</button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>

                    <!-- Add Member Button -->
                    <div class="text-center mt-4">
                        <button type="button" class="btn btn-primary" onclick="addTeamMember()">Dodaj Członka</button>
                    </div>
                </div>

                <!-- Jumbotron Section -->
                <div class="tab-pane fade" id="jumbotron" role="tabpanel" aria-labelledby="jumbotron-tab">
                    <h2>Jumbotron</h2>
                    <div class="mb-3">
                        <label for="jumbotronTitle1" class="form-label">Title 1</label>
                        <input type="text" class="form-control" id="jumbotronTitle1" name="jumbotron[title1]" value="{{ json_data.jumbotron.title1 }}">
                    </div>
                    <div class="mb-3">
                        <label for="jumbotronTitle2" class="form-label">Title 2</label>
                        <input type="text" class="form-control" id="jumbotronTitle2" name="jumbotron[title2]" value="{{ json_data.jumbotron.title2 }}">
                    </div>
                    <div class="mb-3">
                        <label for="jumbotronButton1Text" class="form-label">Button 1 Text</label>
                        <input type="text" class="form-control" id="jumbotronButton1Text" name="jumbotron[button1Text]" value="{{ json_data.jumbotron.button1Text }}">
                    </div>
                    <div class="mb-3">
                        <label for="jumbotronButton2Text" class="form-label">Button 2 Text</label>
                        <input type="text" class="form-control" id="jumbotronButton2Text" name="jumbotron[button2Text]" value="{{ json_data.jumbotron.button2Text }}">
                    </div>
                    <div class="mb-3">
                        <label for="jumbotronImageURL" class="form-label">Image URL</label>
                        <input type="text" class="form-control" id="jumbotronImageURL" name="jumbotron[imageURL]" value="{{ json_data.jumbotron.imageURL }}">
                    </div>
                </div>                

                <!-- Articles Section -->
                <div class="tab-pane fade" id="articles" role="tabpanel" aria-labelledby="articles-tab">
                    <h2>Articles</h2>
                    <div id="articles-list">
                        <!-- Loop through articles -->
                        {% for article in json_data.latestArticles %}
                        <div class="article-item mb-4 border p-3 rounded">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="articleTitle{{ loop.index }}" class="form-label">Title</label>
                                    <input type="text" class="form-control" id="articleTitle{{ loop.index }}" name="latestArticles[{{ loop.index0 }}][title]" value="{{ article.title }}">
                                </div>
                                <div class="col-md-6">
                                    <label for="articleCategory{{ loop.index }}" class="form-label">Category</label>
                                    <input type="text" class="form-control" id="articleCategory{{ loop.index }}" name="latestArticles[{{ loop.index0 }}][category]" value="{{ article.category }}">
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="articleDescription1{{ loop.index }}" class="form-label">Description 1</label>
                                    <input type="text" class="form-control" id="articleDescription1{{ loop.index }}" name="latestArticles[{{ loop.index0 }}][description1]" value="{{ article.description1 }}">
                                </div>
                                <div class="col-md-6">
                                    <label for="articleDescription2{{ loop.index }}" class="form-label">Description 2</label>
                                    <input type="text" class="form-control" id="articleDescription2{{ loop.index }}" name="latestArticles[{{ loop.index0 }}][description2]" value="{{ article.description2 }}">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="articleImageURL{{ loop.index }}" class="form-label">Image URL</label>
                                <input type="text" class="form-control" id="articleImageURL{{ loop.index }}" name="latestArticles[{{ loop.index0 }}][imageURL]" value="{{ article.imageURL }}">
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <button type="button" class="btn btn-danger btn-sm" onclick="removeArticle(this)">Usuń</button>
                                <button type="button" class="btn btn-secondary btn-sm" onclick="editArticle(this)">Edytuj</button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <button type="button" class="btn btn-primary mt-3" onclick="addArticle()">Dodaj Artykuł</button>
                </div>


                <!-- Adventure Section -->
                <div class="tab-pane fade" id="adventure" role="tabpanel" aria-labelledby="adventure-tab">
                    <h2>Adventure</h2>
                    <div class="mb-3">
                        <label for="adventureTitle1" class="form-label">Title 1</label>
                        <input type="text" class="form-control" id="adventureTitle1" name="adventure[title1]" value="{{ json_data.adventure.title1 }}">
                    </div>
                    <div class="mb-3">
                        <label for="adventureTitle2" class="form-label">Title 2</label>
                        <input type="text" class="form-control" id="adventureTitle2" name="adventure[title2]" value="{{ json_data.adventure.title2 }}">
                    </div>
                    <div class="mb-3">
                        <label for="adventureDescription" class="form-label">Description</label>
                        <input type="text" class="form-control" id="adventureDescription" name="adventure[description]" value="{{ json_data.adventure.description }}">
                    </div>
                </div>                
                 
                <!-- Partners Section -->
                <div class="tab-pane fade" id="partners" role="tabpanel" aria-labelledby="partners-tab">
                    <h2>{{ json_data.partners.text1 }}</h2>
                    <div class="row">
                        <div class="mb-3">
                            <label for="partnersText" class="form-label">Text</label>
                            <input type="text" class="form-control" id="partnersText" name="partners[text1]" value="{{ json_data.partners.text1 }}">
                        </div>
                        {% for i in range(json_data.partners.images|length) %}
                        <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
                            <div class="card">
                                <img src="{{ url_for('static', filename=json_data.partners.images[i]) }}" class="img-fluid card-img-top" alt="Partner logo">
                                <div class="card-body">
                                    <!-- Image Link -->
                                    <div class="mb-3">
                                        <label for="partnerImage{{ i }}" class="form-label">Image Link {{ i+1 }}</label>
                                        <input type="text" class="form-control" id="partnerImage{{ i }}" name="partners[images][{{ i }}]" value="{{ json_data.partners.images[i] }}">
                                    </div>

                                    <button type="button" class="btn btn-danger remove-btn" onclick="removePartner(this)">Usuń</button>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                    <button type="button" class="btn btn-secondary mt-4" onclick="addPartner()">Dodaj Partnera</button>
                </div>


                <!-- Video Section -->
                <div class="tab-pane fade" id="video" role="tabpanel" aria-labelledby="video-tab">
                    <h2>Video Gallery</h2>
                    <div class="row">
                        {% for i in range(json_data.video.videos|length) %}
                        <div class="col-md-4">
                            <a href="{{ json_data.video.videos[i] }}" target="_blank">
                                <img src="{{ url_for('static', filename=json_data.video.images[i]) }}" class="img-fluid" alt="Video thumbnail">
                            </a>             
                            <div class="col-md-12 mb-3">
                                <label for="videoTitle{{ i }}" class="form-label">Title {{ i+1 }}</label>
                                <input type="text" class="form-control" id="videoTitle{{ i }}" name="video[title{{ i+1 }}]" value="{{ json_data.video.titles[i] if json_data.video.titles is defined else '' }}">
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="videoLink{{ i }}" class="form-label">Video Link {{ i+1 }}</label>
                                <input type="url" class="form-control" id="videoLink{{ i }}" name="video[videos][{{ i }}]" value="{{ json_data.video.videos[i] }}">
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="videoImage{{ i }}" class="form-label">Video Image {{ i+1 }}</label>
                                <input type="text" class="form-control" id="videoImage{{ i }}" name="video[images][{{ i }}]" value="{{ json_data.video.images[i] }}">
                            </div>
                            <button type="button" class="remove-btn" onclick="removeVideo(this)">Usuń</button>    
                        </div>
                        {% endfor %}
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="addVideo()">Dodaj Video</button>
                </div>  

            </div>
            <div class="mt-4">
                <!-- Button obsługujący formularz -->
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>

    <!-- Modalny do edycji elementu -->
    <div class="modal fade" id="editItemModal" tabindex="-1" aria-labelledby="editItemModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editItemModalLabel">Edytuj element</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zamknij"></button>
                </div>
                <div class="modal-body">
                    <form id="editItemForm">
                        <!-- Edytowalne pola formularza znajdują się tutaj -->
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-wtórny" data-bs-dismiss="modal">Zamknij</button>
                    <button type="button" class="btn btn-primary" id="saveItemChangesBtn">Zapisz zmiany</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="statusModal" tabindex="-1" aria-labelledby="statusModalLabel" aria-hidden="true">
        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="statusModalLabel">Status operacji</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            <p id="statusMessage"></p>
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
            </div>
        </div>
        </div>
    </div>

    <!-- Modal browser HTML -->
    <div class="modal fade" id="fileBrowserModal" tabindex="-1" aria-labelledby="fileBrowserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="fileBrowserModalLabel">File Browser</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="fileSearch" class="form-label">Search Files:</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="fileSearch" placeholder="Search files">
                            <button class="btn btn-primary" id="searchBtn">Search</button>
                        </div>
                    </div>
                    <ul id="fileList" class="list-group mb-3"></ul>
                    <nav aria-label="Page navigation">
                        <ul class="pagination">
                            <li class="page-item" id="prevPage">
                                <button class="page-link">Previous</button>
                            </li>
                            <li class="page-item" id="nextPage">
                                <button class="page-link">Next</button>
                            </li>
                        </ul>
                    </nav>
                    <div id="fileDetails" class="d-none">
                        <div class="mb-3">
                            <label for="newFileName" class="form-label">Rename File:</label>
                            <input type="text" class="form-control" id="newFileName">
                        </div>
                        <button type="button" class="btn btn-primary" id="renameFileBtn">Rename</button>
                        <div id="filePreview" class="mt-3"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="okBtn">OK</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sortablejs@1.8.4/Sortable.min.js"></script>

    <script>

        document.addEventListener('DOMContentLoaded', function() {
            // Obsługa formularza
            const form = document.querySelector('form'); 
            if (form) {
                form.addEventListener('submit', function(event) {
                    event.preventDefault(); 
                    const formData = new FormData(form);
                    fetch(form.action, {
                        method: 'POST',
                        body: formData,
                    })
                    .then(response => response.json())
                    .then(data => {
                        const statusMessage = document.getElementById('statusMessage');
                        if (data.success) {
                            statusMessage.textContent = data.message;
                            form.reset();
                        } else {
                            statusMessage.textContent = `Błąd: ${data.message}`;
                        }
                        const statusModal = new bootstrap.Modal(document.getElementById('statusModal'));
                        statusModal.show();
                    })
                    .catch(error => {
                        const statusMessage = document.getElementById('statusMessage');
                        statusMessage.textContent = `Błąd: ${error}`;
                        const statusModal = new bootstrap.Modal(document.getElementById('statusModal'));
                        statusModal.show();
                    });
                });
            }

            // Obsługa kontenera z elementami karuzeli
            const container = document.getElementById('carouselItemsContainer');
            if (container) {
                Sortable.create(container, {
                    animation: 150,
                    onEnd: function (evt) {
                        console.log('Item moved');
                    }
                });

                container.addEventListener('click', function(event) {
                    const target = event.target;
                    if (target.classList.contains('edit-btn')) {
                        const card = target.closest('.col-md-4');
                        if (card) {
                            console.log('Edit button clicked for card:', card.dataset.index);
                            editItem(card);
                        }
                    } else if (target.classList.contains('remove-btn')) {
                        const card = target.closest('.col-md-4');
                        if (card) {
                            console.log('Remove button clicked for card:', card.dataset.index);
                            removeItem(card);
                        }
                    }
                });

                document.getElementById('addNewItemBtn').addEventListener('click', addItem);
                document.getElementById('saveItemChangesBtn').addEventListener('click', saveItemChanges);
            }
        });

        function editItem(card) {
            console.log('Wywołano funkcję edycji elementu dla indeksu karty:', card.dataset.index);

            const modalElement = document.getElementById('editItemModal');
            if (!modalElement) {
                console.error('Nie znaleziono modalu edycji elementu.');
                return;
            }

            const modal = new bootstrap.Modal(modalElement);
            modal.show();

            const modalBody = modalElement.querySelector('.modal-body');
            if (!modalBody) {
                console.error('Nie znaleziono ciała modalu.');
                return;
            }

            const index = card.dataset.index; // Pobierz dynamicznie indeks z atrybutu data-index karty

            // Usuń poprzedni formularz, jeśli istnieje
            modalBody.innerHTML = '';

            // Wygeneruj nowy formularz
            const form = document.createElement('form');
            form.id = 'editItemForm';
            form.dataset.index = index;

            const videoSrc = card.querySelector(`[name="carouselItems[${index - 1}][videoSrc]"]`);
            const videoMobileSrc = card.querySelector(`[name="carouselItems[${index - 1}][videoMobileSrc]"]`);
            const maskColor = card.querySelector(`[name="carouselItems[${index - 1}][maskColor]"]`);
            const heading = card.querySelector(`[name="carouselItems[${index - 1}][heading]"]`);
            const subheading = card.querySelector(`[name="carouselItems[${index - 1}][subheading]"]`);
            const buttonText = card.querySelector(`[name="carouselItems[${index - 1}][buttons][0][text]"]`);
            const buttonUrl = card.querySelector(`[name="carouselItems[${index - 1}][buttons][0][url]"]`);

            if (!videoSrc || !videoMobileSrc || !maskColor || !heading || !subheading || !buttonText || !buttonUrl) {
                console.error('Nie znaleziono jednego lub więcej elementów w karcie.');
                return;
            }

            form.innerHTML = `
                <div class="mb-3">
                    <label for="videoSrc_${index}" class="form-label">Video Source:</label>
                    <input type="text" class="form-control" id="videoSrc_${index}" name="carouselItems[${index - 1}][videoSrc]" value="${videoSrc.value}">
                </div>
                <div class="mb-3">
                    <label for="videoMobileSrc_${index}" class="form-label">Video Mobile Source:</label>
                    <input type="text" class="form-control" id="videoMobileSrc_${index}" name="carouselItems[${index - 1}][videoMobileSrc]" value="${videoMobileSrc.value}">
                </div>
                <div class="mb-3">
                    <label for="maskColor_${index}" class="form-label">Mask Color:</label>
                    <input type="text" class="form-control" id="maskColor_${index}" name="carouselItems[${index - 1}][maskColor]" value="${maskColor.value}">
                </div>
                <div class="mb-3">
                    <label for="heading_${index}" class="form-label">Heading:</label>
                    <input type="text" class="form-control" id="heading_${index}" name="carouselItems[${index - 1}][heading]" value="${heading.value}">
                </div>
                <div class="mb-3">
                    <label for="subheading_${index}" class="form-label">Subheading:</label>
                    <input type="text" class="form-control" id="subheading_${index}" name="carouselItems[${index - 1}][subheading]" value="${subheading.value}">
                </div>
                <div class="mb-3">
                    <label for="buttonText_${index}" class="form-label">Button Text:</label>
                    <input type="text" class="form-control" id="buttonText_${index}" name="carouselItems[${index - 1}][buttons][0][text]" value="${buttonText.value}">
                </div>
                <div class="mb-3">
                    <label for="buttonUrl_${index}" class="form-label">Button URL:</label>
                    <input type="text" class="form-control" id="buttonUrl_${index}" name="carouselItems[${index - 1}][buttons][0][url]" value="${buttonUrl.value}">
                </div>
            `;
            
            // Dodaj formularz do ciała modalu
            modalBody.appendChild(form);
        }


        function saveItemChanges() {
            const form = document.getElementById('editItemForm');
            if (!form) {
                console.error('Edit form not found.');
                return;
            }

            const index = form.dataset.index;
            if (!index) {
                console.error('Form index not found.');
                return;
            }

            const card = document.querySelector(`div[data-index="${index}"] .card-body`);
            if (!card) {
                console.error('Card not found for index:', index);
                return;
            }

            // Update card fields with form values
            console.log('Saving changes for card index:', index);
            const inputs = form.querySelectorAll('input');
            inputs.forEach(input => {
                const field = card.querySelector(`#${input.id}`);
                if (field) {
                    field.value = input.value;
                }
            });
        }

        function addItem() {
            console.log('addItem function called');

            const container = document.getElementById('carouselItemsContainer');
            const newIndex = container.querySelectorAll('.col-md-4').length + 1;
            const newItem = document.createElement('div');
            newItem.className = 'col-md-4 mb-3';
            newItem.dataset.index = newIndex;

            newItem.innerHTML = `
                <div class="card shadow-sm">
                    <div class="card-header bg-primary text-white">
                        Slide ${newIndex}
                        <button type="button" class="btn btn-warning btn-sm float-end ms-2 edit-btn">
                            <i class="bi bi-pencil-square"></i> Edit
                        </button>
                        <button type="button" class="btn btn-danger btn-sm float-end remove-btn">
                            <i class="bi bi-trash"></i> Remove
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="videoSrc_${newIndex}" class="form-label">Video Source:</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="videoSrc_${newIndex}" name="carouselItems[${newIndex - 1}][videoSrc]">
                                <button type="button" class="btn btn-secondary browse-btn" data-index="${newIndex}" data-type="komputer">
                                    <i class="bi bi-folder-symlink"></i> Browse Server Files
                                </button>
                            </div>
                            <input type="file" class="form-control mt-2" id="videoFileSrc_${newIndex}" data-index="${newIndex}" data-type="komputer" accept="video/mp4">
                        </div>
                        <div class="mb-3">
                            <label for="videoMobileSrc_${newIndex}" class="form-label">Video Mobile Source:</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="videoMobileSrc_${newIndex}" name="carouselItems[${newIndex - 1}][videoMobileSrc]">
                                <button type="button" class="btn btn-secondary browse-btn" data-index="${newIndex}" data-type="mobile">
                                    <i class="bi bi-folder-symlink"></i> Browse Server Files
                                </button>
                            </div>
                            <input type="file" class="form-control mt-2" id="videoFileMobileSrc_${newIndex}" data-index="${newIndex}" data-type="mobile" accept="video/mp4">
                        </div>
                        <div class="mb-3">
                            <label for="maskColor_${newIndex}" class="form-label">Mask Color:</label>
                            <input type="text" class="form-control" id="maskColor_${newIndex}" name="carouselItems[${newIndex - 1}][maskColor]">
                        </div>
                        <div class="mb-3">
                            <label for="heading_${newIndex}" class="form-label">Heading:</label>
                            <input type="text" class="form-control" id="heading_${newIndex}" name="carouselItems[${newIndex - 1}][heading]">
                        </div>
                        <div class="mb-3">
                            <label for="subheading_${newIndex}" class="form-label">Subheading:</label>
                            <input type="text" class="form-control" id="subheading_${newIndex}" name="carouselItems[${newIndex - 1}][subheading]">
                        </div>
                        <div class="mb-3">
                            <label for="buttonText_${newIndex}" class="form-label">Button Text:</label>
                            <input type="text" class="form-control" id="buttonText_${newIndex}" name="carouselItems[${newIndex - 1}][buttons][0][text]">
                        </div>
                        <div class="mb-3">
                            <label for="buttonUrl_${newIndex}" class="form-label">Button URL:</label>
                            <input type="text" class="form-control" id="buttonUrl_${newIndex}" name="carouselItems[${newIndex - 1}][buttons][0][url]">
                        </div>
                        <div class="mb-3">
                            <label for="buttonClass_${newIndex}" class="form-label">Button Class:</label>
                            <input type="text" class="form-control" id="buttonClass_${newIndex}" name="carouselItems[${newIndex - 1}][buttons][0][class]">
                        </div>
                        <div class="mb-3">
                            <label for="videoPreview_${newIndex}" class="form-label">Video Preview:</label>
                            <video id="videoPreview_${newIndex}" class="w-100" controls>
                                <source src="" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(newItem);

            // Event listeners for file inputs
            document.getElementById(`videoFileSrc_${newIndex}`).addEventListener('change', uploadFile);
            document.getElementById(`videoFileMobileSrc_${newIndex}`).addEventListener('change', uploadFile);

            // Event listeners for browse buttons
            document.querySelector(`.browse-btn[data-index="${newIndex}"][data-type="komputer"]`).addEventListener('click', browseFiles);
            document.querySelector(`.browse-btn[data-index="${newIndex}"][data-type="mobile"]`).addEventListener('click', browseFiles);
        }

        /* PRZEGLĄDARKA PLIKÓW */

        let currentPage = 1;
        const filesPerPage = 10;
        let allFiles = [];
        let fileType = '';
        let selectedFile = '';
        let selectedIndex = '';
        let selectedFileType = '';

        function uploadFile(event) {
            const fileInput = event.target;
            const index = fileInput.dataset.index;
            const type = fileInput.dataset.type;
            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            fetch(`/user/upload_hero_video?type=${type}&index=${index}`, {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById(`videoSrc_${index}`).value = data.filePath;
                    document.getElementById(`videoPreview_${index}`).querySelector('source').src = data.filePath;
                    document.getElementById(`videoPreview_${index}`).load();
                } else {
                    alert('File upload failed');
                }
            })
            .catch(error => console.error('Error uploading file:', error));
        }

        function browseFiles(event) {
            const button = event.target;
            const index = button.dataset.index;
            const type = button.dataset.type;
            selectedIndex = button.dataset.index;
            selectedFileType = button.dataset.type;
            fileType = button.dataset.type; // Get file type from button data attribute
            console.log(type)
            console.log(fileType)
            fetch(`/user/browse_hero_files?type=${type}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    allFiles = data.files;
                    renderFileList();
                    const fileBrowserModal = new bootstrap.Modal(document.getElementById('fileBrowserModal'));
                    fileBrowserModal.show();
                } else {
                    alert('Failed to retrieve files');
                }
            })
            .catch(error => console.error('Error browsing files:', error));
        }

        function renderFileList() {
            const fileListContainer = document.getElementById('fileList');
            fileListContainer.innerHTML = '';
            const paginatedFiles = paginateFiles(allFiles, currentPage, filesPerPage);

            paginatedFiles.forEach(file => {
                const listItem = document.createElement('li');
                listItem.className = 'list-group-item list-group-item-action d-flex justify-content-between align-items-center';
                listItem.textContent = file;
                listItem.style.cursor = 'pointer';

                listItem.addEventListener('click', () => {
                    selectFile(file);
                });

                fileListContainer.appendChild(listItem);
            });

            updatePaginationControls();
        }

        function paginateFiles(files, page, filesPerPage) {
            const start = (page - 1) * filesPerPage;
            const end = start + filesPerPage;
            return files.slice(start, end);
        }

        function updatePaginationControls() {
            document.getElementById('prevPage').classList.toggle('disabled', currentPage === 1);
            document.getElementById('nextPage').classList.toggle('disabled', currentPage === Math.ceil(allFiles.length / filesPerPage));
        }

        document.getElementById('prevPage').addEventListener('click', () => {
            if (currentPage > 1) {
                currentPage--;
                renderFileList();
            }
        });

        document.getElementById('nextPage').addEventListener('click', () => {
            if (currentPage < Math.ceil(allFiles.length / filesPerPage)) {
                currentPage++;
                renderFileList();
            }
        });

        document.getElementById('searchBtn').addEventListener('click', () => {
            const query = document.getElementById('fileSearch').value.toLowerCase();
            allFiles = allFiles.filter(file => file.toLowerCase().includes(query));
            currentPage = 1;
            renderFileList();
        });

        const FILES = {
            'komputer': '/static/efekty/adds/galeria/video/komputer/',
            'mobile': '/static/efekty/adds/galeria/video/mobile/',
            'member_image': '/static/efekty/adds/hero/assets/',
            'galeria': '/static/efekty/adds/galeria/assets/'
        };

        function selectFile(file) {
            selectedFile = file;
            document.getElementById('newFileName').value = file;
            document.getElementById('fileDetails').classList.remove('d-none');
            document.getElementById('renameFileBtn').onclick = function() {
                renameFile(file);
            };

            const fileExtension = file.split('.').pop().toLowerCase();
            const filePreviewContainer = document.getElementById('filePreview');
            filePreviewContainer.innerHTML = '';

            let filePath = '';

            // Wybór ścieżki na podstawie wartości fileType
            if (fileType in FILES) {
                filePath = FILES[fileType];
            } else {
                filePath = '/static/efekty/adds/galeria/video/';
                console.log('Została zwrócona nieprawidłowa ścieżka, spradź zmienną const Files')
            }

            if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                const img = document.createElement('img');
                img.src = `${filePath}${file}`;
                img.alt = file;
                img.className = 'img-fluid';
                filePreviewContainer.appendChild(img);
            } else if (fileExtension === 'mp4') {
                const video = document.createElement('video');
                video.className = 'w-100';
                video.controls = true;
                const source = document.createElement('source');
                source.src = `${filePath}${file}`;
                source.type = 'video/mp4';
                video.appendChild(source);
                video.innerHTML += 'Your browser does not support the video tag.';
                filePreviewContainer.appendChild(video);
            } else {
                const p = document.createElement('p');
                p.textContent = 'Preview not available for this file type.';
                filePreviewContainer.appendChild(p);
            }
        }


        function renameFile(oldFileName) {
            const newFileName = document.getElementById('newFileName').value;

            if (!newFileName) {
                alert('New file name cannot be empty.');
                return;
            }

            fetch(`/user/change_hero_names_files?old_name=${encodeURIComponent(oldFileName)}&new_name=${encodeURIComponent(newFileName)}`, {
                method: 'POST',
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('File renamed successfully.');
                    browseFiles({ target: document.querySelector('.browse-btn') });
                } else {
                    alert('Failed to rename file.');
                }
            })
            .catch(error => console.error('Error renaming file:', error));
        }

        document.getElementById('okBtn').addEventListener('click', () => {
            if (selectedFile && selectedIndex) {
                const filePath = `/static/efekty/adds/galeria/video/${selectedFileType}/${selectedFile}`;
                if (selectedFileType === 'komputer') {
                    document.getElementById(`videoSrc_${selectedIndex}`).value = filePath;
                    document.getElementById(`videoPreview_${selectedIndex}`).querySelector('source').src = filePath;
                } else if (selectedFileType === 'mobile') {
                    document.getElementById(`videoMobileSrc_${selectedIndex}`).value = filePath;
                    document.getElementById(`videoPreview_${selectedIndex}`).querySelector('source').src = filePath;
                }
                document.getElementById(`videoPreview_${selectedIndex}`).load();
                const fileBrowserModal = bootstrap.Modal.getInstance(document.getElementById('fileBrowserModal'));
                fileBrowserModal.hide();
            }
        });

        /* KONIEC PRZEGLĄDARKI PLIKÓW */

        function removeItem(card) {
            console.log('removeItem function called for card:', card.dataset.index);

            if (card) {
                card.remove();
                console.log('Card removed:', card.dataset.index);
            } else {
                console.error('Card not found.');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Dodawanie nowego członka zespołu
            window.addTeamMember = function() {
                // Pobierz listę członków zespołu
                const teamList = document.getElementById('team-list');
                const memberIndex = teamList.children.length + 1;

                // Utwórz nową kartę członka zespołu
                const newMember = document.createElement('div');
                newMember.className = 'card shadow-sm mb-4 team-member';
                newMember.innerHTML = `
                    <div class="card-body">
                        <h4 class="card-title">Member ${memberIndex}</h4>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="teamName${memberIndex}" class="form-label">Name</label>
                                <input type="text" class="form-control" id="teamName${memberIndex}" name="membersTeamSection[members][${memberIndex - 1}][name]" value="">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="teamRole${memberIndex}" class="form-label">Role</label>
                                <input type="text" class="form-control" id="teamRole${memberIndex}" name="membersTeamSection[members][${memberIndex - 1}][role]" value="">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="teamImage${memberIndex}" class="form-label">Image URL</label>
                                <input type="text" class="form-control" id="teamImage${memberIndex}" name="membersTeamSection[members][${memberIndex - 1}][imageURL]" value="">
                            </div>
                            <div class="col-md-8 mb-3">
                                <label for="teamBiography${memberIndex}" class="form-label">Biography</label>
                                <textarea class="form-control" id="teamBiography${memberIndex}" name="membersTeamSection[members][${memberIndex - 1}][details][biography]" rows="3"></textarea>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="teamExperience${memberIndex}" class="form-label">Experience</label>
                            <textarea class="form-control" id="teamExperience${memberIndex}" name="membersTeamSection[members][${memberIndex - 1}][details][expirience]" rows="2"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="teamProjects${memberIndex}" class="form-label">Projects</label>
                            <textarea class="form-control" id="teamProjects${memberIndex}" name="membersTeamSection[members][${memberIndex - 1}][details][projects]" rows="2"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="teamTechniques${memberIndex}" class="form-label">Techniques</label>
                            <textarea class="form-control" id="teamTechniques${memberIndex}" name="membersTeamSection[members][${memberIndex - 1}][details][techniques]" rows="2"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="teamSocialIcons${memberIndex}" class="form-label">Social Icons</label>
                                <input type="text" class="form-control mb-1" id="teamSocialIcons${memberIndex}_0" name="membersTeamSection[members][${memberIndex - 1}][socialIcons][]" value="">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="teamSocialLinks${memberIndex}" class="form-label">Social Links</label>
                                <input type="text" class="form-control mb-1" id="teamSocialLinks${memberIndex}_0" name="membersTeamSection[members][${memberIndex - 1}][socialLinks][]" value="">
                            </div>
                        </div>
                        <button type="button" class="btn btn-danger btn-sm mt-3" onclick="removeTeamMember(this)">Usuń</button>
                    </div>
                `;
                
                // Dodaj nowego członka do listy
                teamList.appendChild(newMember);
            };

            // Usuwanie członka zespołu
            window.removeTeamMember = function(button) {
                const memberCard = button.closest('.team-member');
                memberCard.remove();

                // Aktualizacja numeracji członków zespołu
                const teamList = document.getElementById('team-list');
                const members = teamList.children;
                for (let i = 0; i < members.length; i++) {
                    members[i].querySelector('.card-title').textContent = `Member ${i + 1}`;
                    updateMemberFields(members[i], i);
                }
            };

            // Aktualizacja identyfikatorów pól dla członków zespołu
            function updateMemberFields(memberElement, index) {
                const memberIndex = index + 1;

                memberElement.querySelector('[id^="teamName"]').id = `teamName${memberIndex}`;
                memberElement.querySelector('[name^="membersTeamSection[members]"]').name = `membersTeamSection[members][${index}][name]`;
                
                memberElement.querySelector('[id^="teamRole"]').id = `teamRole${memberIndex}`;
                memberElement.querySelector('[name^="membersTeamSection[members]"]').name = `membersTeamSection[members][${index}][role]`;

                memberElement.querySelector('[id^="teamImage"]').id = `teamImage${memberIndex}`;
                memberElement.querySelector('[name^="membersTeamSection[members]"]').name = `membersTeamSection[members][${index}][imageURL]`;

                memberElement.querySelector('[id^="teamBiography"]').id = `teamBiography${memberIndex}`;
                memberElement.querySelector('[name^="membersTeamSection[members]"]').name = `membersTeamSection[members][${index}][details][biography]`;

                memberElement.querySelector('[id^="teamExperience"]').id = `teamExperience${memberIndex}`;
                memberElement.querySelector('[name^="membersTeamSection[members]"]').name = `membersTeamSection[members][${index}][details][expirience]`;

                memberElement.querySelector('[id^="teamProjects"]').id = `teamProjects${memberIndex}`;
                memberElement.querySelector('[name^="membersTeamSection[members]"]').name = `membersTeamSection[members][${index}][details][projects]`;

                memberElement.querySelector('[id^="teamTechniques"]').id = `teamTechniques${memberIndex}`;
                memberElement.querySelector('[name^="membersTeamSection[members]"]').name = `membersTeamSection[members][${index}][details][techniques]`;

                const socialIcons = memberElement.querySelectorAll('[id^="teamSocialIcons"]');
                socialIcons.forEach((icon, i) => {
                    icon.id = `teamSocialIcons${memberIndex}_${i}`;
                    icon.name = `membersTeamSection[members][${index}][socialIcons][${i}]`;
                });

                const socialLinks = memberElement.querySelectorAll('[id^="teamSocialLinks"]');
                socialLinks.forEach((link, i) => {
                    link.id = `teamSocialLinks${memberIndex}_${i}`;
                    link.name = `membersTeamSection[members][${index}][socialLinks][${i}]`;
                });
            }
        });

        let articleIndex = {{ json_data.latestArticles | length }}; // Start index for new articles

        // Function to add a new article
        function addArticle() {
            articleIndex++; // Increment index for new article

            // Create a new article element
            const articleHTML = `
                <div class="article-item mb-4 border p-3 rounded">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="articleTitle${articleIndex}" class="form-label">Title</label>
                            <input type="text" class="form-control" id="articleTitle${articleIndex}" name="latestArticles[${articleIndex}][title]">
                        </div>
                        <div class="col-md-6">
                            <label for="articleCategory${articleIndex}" class="form-label">Category</label>
                            <input type="text" class="form-control" id="articleCategory${articleIndex}" name="latestArticles[${articleIndex}][category]">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="articleDescription1${articleIndex}" class="form-label">Description 1</label>
                            <input type="text" class="form-control" id="articleDescription1${articleIndex}" name="latestArticles[${articleIndex}][description1]">
                        </div>
                        <div class="col-md-6">
                            <label for="articleDescription2${articleIndex}" class="form-label">Description 2</label>
                            <input type="text" class="form-control" id="articleDescription2${articleIndex}" name="latestArticles[${articleIndex}][description2]">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="articleImageURL${articleIndex}" class="form-label">Image URL</label>
                        <input type="text" class="form-control" id="articleImageURL${articleIndex}" name="latestArticles[${articleIndex}][imageURL]">
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                        <button type="button" class="btn btn-danger btn-sm" onclick="removeArticle(this)">Usuń</button>
                        <button type="button" class="btn btn-secondary btn-sm" onclick="editArticle(this)">Edytuj</button>
                    </div>
                </div>
            `;

            // Append the new article to the articles list
            document.getElementById('articles-list').insertAdjacentHTML('beforeend', articleHTML);
        }

        // Function to remove an article
        function removeArticle(button) {
            const articleItem = button.closest('.article-item');
            articleItem.remove(); // Remove the article item from the DOM
        }

        // Function to edit an article (for now, just logs the edit action)
        function editArticle(button) {
            const articleItem = button.closest('.article-item');
            const title = articleItem.querySelector('input[name$="[title]"]').value;
            const category = articleItem.querySelector('input[name$="[category]"]').value;
            const description1 = articleItem.querySelector('input[name$="[description1]"]').value;
            const description2 = articleItem.querySelector('input[name$="[description2]"]').value;
            const imageURL = articleItem.querySelector('input[name$="[imageURL]"]').value;

            console.log('Edit Article:', { title, category, description1, description2, imageURL });

            // You can replace the console log with actual edit functionality
        }

        // Funkcja do usuwania partnera
        function removePartner(button) {
            const partnerCard = button.closest('.col-sm-6'); // Znajduje najbliższą kolumnę
            partnerCard.remove(); // Usuwa kolumnę z DOM
        }

        // Funkcja do dodawania nowego partnera
        function addPartner() {
            // Pobierz kontener z partnerami
            const partnersContainer = document.querySelector('#partners .row');
            
            // Ustal indeks dla nowego partnera
            const newIndex = partnersContainer.children.length;

            // Tworzenie nowej karty partnera
            const newPartner = document.createElement('div');
            newPartner.classList.add('col-sm-6', 'col-md-4', 'col-lg-3', 'mb-4');
            
            newPartner.innerHTML = `
                <div class="card">
                    <img src="" class="img-fluid card-img-top" alt="Partner logo">
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="partnerImage${newIndex}" class="form-label">Image Link ${newIndex + 1}</label>
                            <input type="text" class="form-control" id="partnerImage${newIndex}" name="partners[images][${newIndex}]" value="">
                        </div>
                        <button type="button" class="btn btn-danger remove-btn" onclick="removePartner(this)">Usuń</button>
                    </div>
                </div>
            `;

            // Dodaj nową kartę do kontenera
            partnersContainer.appendChild(newPartner);
        }


        // Functions to add/remove clients
        function addClient() {
            const clientsList = document.getElementById('clients-list');
            const clientCount = clientsList.children.length;
            const newClient = document.createElement('div');
            newClient.className = 'client-item mb-4';
            newClient.innerHTML = `
                <h3>Client ${clientCount + 1}</h3>
                <div class="mb-3">
                    <label for="clientName${clientCount + 1}" class="form-label">Name</label>
                    <input type="text" class="form-control" id="clientName${clientCount + 1}" name="clients[${clientCount}][name]">
                </div>
                <div class="mb-3">
                    <label for="clientLogo${clientCount + 1}" class="form-label">Logo URL</label>
                    <input type="text" class="form-control" id="clientLogo${clientCount + 1}" name="clients[${clientCount}][logo]">
                </div>
                <button type="button" class="remove-btn" onclick="removeClient(this)">Usuń</button>
            `;
            clientsList.appendChild(newClient);
        }

        function removeClient(button) {
            button.closest('.client-item').remove();
        }

        function addVideo() {
            // Pobierz numer wideo (liczba istniejących elementów)
            const videoCount = document.querySelectorAll('#video .col-md-4').length;

            // Znajdź kontener wideo
            const videoContainer = document.querySelector('#video .row');

            // Stwórz nowy blok HTML
            const newVideoBlock = `
                <div class="col-md-4">
                    <a href="#" target="_blank">
                        <img src="" class="img-fluid" alt="Video thumbnail">
                    </a>             
                    <div class="col-md-12 mb-3">
                        <label for="videoTitle${videoCount}" class="form-label">Title ${videoCount + 1}</label>
                        <input type="text" class="form-control" id="videoTitle${videoCount}" name="video[title${videoCount + 1}]" value="">
                    </div>
                    <div class="col-md-12 mb-3">
                        <label for="videoLink${videoCount}" class="form-label">Video Link ${videoCount + 1}</label>
                        <input type="url" class="form-control" id="videoLink${videoCount}" name="video[videos][${videoCount}]" value="">
                    </div>
                    <div class="col-md-12 mb-3">
                        <label for="videoImage${videoCount}" class="form-label">Video Image ${videoCount + 1}</label>
                        <input type="text" class="form-control" id="videoImage${videoCount}" name="video[images][${videoCount}]" value="">
                    </div>
                    <button type="button" class="remove-btn" onclick="removeVideo(this)">Usuń</button>    
                </div>
            `;

            // Dodaj nowy blok do kontenera
            videoContainer.insertAdjacentHTML('beforeend', newVideoBlock);
        }

        function removeVideo(button) {
            // Znajdź kontener rodzica i usuń go
            const videoBlock = button.closest('.col-md-4');
            videoBlock.remove();
        }


    </script>
</body>
</html>
